<html>
<head>
<meta charset="UTF-8">
<meta name="theme-color" content="#fff">
<title>Defiant Lee: A Naive Bayes Twitter Bot</title>
<link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,100italic,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
<link href="../css/style.css" rel="stylesheet" type="text/css">
<link rel="icon" type="image/png" href="http://tylerkrupicka.com/images/favicon.png">

<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-51635607-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
 </script>

</head>

<body>

<div id="page-wrap-all">
  <div id="content">
   <h2>Defiant Lee: A Naive Bayes Twitter Bot</h2>
    <div id="date">written 2014-09-27</div>
    <p>In the last week a friend pointed out how common it is for people to mistype "definitely" as "defiantly" on twitter, often because of autocorrect. I decided to try using the tweepy twitter library for python to create a twitter bot that responds to people when they make the mistake.</p><p><a href="https://github.com/tylerkrupicka/DefiantLee">On Github</a> | <a href="https://twitter.com/DefiantLee_/with_replies">Twitter</a></p><!-- more --><img id="postimg" src="http://tylerkrupicka.com/assets/defiant/poll.jpg" alt="polling"><h2>Starting Out</h2><p>To start out, I created a simple function using the api.search() tweepy client to respond to a tweet using defiantly every two minutes. This initial program was very naive, because it automatically assumed that tweets with the word defiantly were using it wrong. Surprisingly, a vast majority of the tweets that the bot responded to actually did misuse the word.</p><img id="postimg" src="http://tylerkrupicka.com/assets/defiant/bestbuy.jpg" alt="bestbuy"><h2>Removing Retweets</h2><p>After letting the bot run for a while, I quickly realized that the bot shouldn't be able to respond to retweets. When it responded to them, the user was often confused because they personally did not misuse defiantly-- meaning there was no context for the response. Additionally, the retweet responses did not show up as a conversation, making them even more confusing.</p><p>To remedy the retweet problem, the program uses the hasattr() python function to check if the tweet has the "retweeted_status" attribute. If it has this attribute the tweet is a retweet and can then be discarded during polling.</p><h2>Let's Talk About Polling</h2><p>It's generally accepted that Twitter limits users and automation to about 1000 tweets a day, which is much more strict on automated accounts. Since there are 1440 minutes in a day, that means at most a bot can post ever 1.44 minutes. I decided to post every 1.5 to be safe (I still got a "limit exceeded" error once).<br /><br />So what does the bot do during this time period? I decided to have the Defiant Lee bot continue polling tweets using threads, allowing me to get a large collection of misuses over the one and a half minutes. I could then sort the tweets by comparing users, so that the bot always responded to the user with the most followers. This allowed the bot to correct big name accounts whenever they made the mistake.</p><h2>Creating a Corpus</h2><p>In order to make the bot do real thinking before choosing tweets, I needed a corpus of correct and incorrect uses to create a machine learning classifier. Over the course of five days, I had the bot save tweets that it responded to so that I could annotate them and create a usable corpus. Over that time period the bot saved 1,600 tweets, a vast majority of which were incorrect uses.</p><img id="postimg" src="http://tylerkrupicka.com/assets/defiant/corpus.jpg" alt="corpus"><h2>Generating Features</h2><p>I decided to create a feature set that exclusively looked at the words immediately before and after defiantly. After testing a variety of different features for correctness in classifying, I found the most deterministic to be:<br /><br />1. The words used immediately before and after defiantly.<br />2. The last letter of the word immediately before and after.<br />3. The part of speech of the word before and after.<br /><br />For part of speech tagging, I used the NLTK Maxent part of speech tagger to label the words in each tweet.</p><h2>The Classifier</h2><p>After features were generated for every tweet in the corpus, I could then create and train a NLTK Naive Bayes classifier. I loaded each of the tweets in the correct and incorrect usage corpus and then used the classifier to classify future incoming tweets. This allowed the program to only respond to tweets that it actually determines are incorrect. It's still wasn't perfect, but it was very good at finding incorrect usage. Additionally, the classifier was more and more accurate based on a constantly increasing data set.</p><img id="postimg" src="http://tylerkrupicka.com/assets/defiant/british.jpg" alt="britishairlines"><h2>Update: A Good Run</h2><p>A couple weeks (and about 12,000) tweets later, the bot's api key finally got taken away--pretty unsurprisingly. Twitter has gotten very strict on their rules and regulations regarding automation, which now prohibits interacting with users without their explicit permission. Bots like mine and the infamous <a href="https://twitter.com/StealthMountain">Stealth Mountain</a> don't fit in to these new restrictions, so it was only a matter of time before the key was removed.</p><p>@BestBuySupport will just have to start proofreading.</p><img id="postimg" src="http://tylerkrupicka.com/assets/defiant/bestbuy2.jpg" alt="best buy mistake again">
  </div>
</div>
<div id="footer">
<div id="footertext">&copy; Tyler Krupicka 2015</div></div>
</body>
</html>
<!--Generated Using Staticky, by Tyler Krupicka -->